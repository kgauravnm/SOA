from selenium import webdriver
from selenium.webdriver.edge.service import Service
from selenium.webdriver.edge.options import Options
from selenium.webdriver.common.by import By
import time

# === Setup ===
driver_path = r"C:\Automation\driver\msedgedriver.exe"
portal_url = "https://your.portal.url"  # Change to your actual portal
options = Options()
options.add_argument("--start-maximized")
driver = webdriver.Edge(service=Service(driver_path), options=options)

# === Step 1: Open Portal and Login ===
driver.get(portal_url)
print("üîê Please complete SSO login... waiting 30 seconds")
time.sleep(30)

# === Step 2: Locate AG-Grid rows ===
rows = driver.find_elements(By.XPATH, "//div[@role='row' and contains(@class, 'ag-row')]")
print(f"‚úÖ Found {len(rows)} AG-Grid rows")

# === Step 3: Print raw HTML of first 3 rows ===
for i in range(min(3, len(rows))):
    print(f"\nüìÑ Row {i+1} inner HTML:")
    
    # Scroll into view (for AG-Grid virtualization)
    driver.execute_script("arguments[0].scrollIntoView(true);", rows[i])
    time.sleep(1)
    
    html = rows[i].get_attribute("innerHTML")
    print(html)

# === Step 4: Done
driver.quit()